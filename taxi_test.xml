<context>
  <input id="greeting" pattern="(привет|здравствуй|добрый день|добрый вечер) *">
    <output value="Привет, $UserName! Хочешь вызвать такси?" if="full($UserName)"/>
    <context id="name_is_empty" if="empty($UserName)">
      <output value="Привет! Как тебя зовут?"/>
      <input pattern="$Text">
        <var name="UserName" value="$Text" scope="user"/>
        <output value="Приятно познакомиться, $UserName! Я могу помочь тебе вызвать такси. В каком городе ты сейчас находишься?"/>
		<context>
		 <input pattern="(Москва|Екатеринбург|Калининград|В Москве|Екатеринбурге|В Калининграде)">
			<output value="Спасибо! Где ты будешь ждать машину? Мне нужен точный адрес."/>
			<context>
			 <input pattern="[улица] * дом * [(корпус|строение)] *">
			  <output value="А куда ты хочешь приехать?"/> 
			  <context>
			   <input pattern="[улица] * дом * (корпус|строение) *">
			  <output value="Спасибо! Сейчас я рассчитаю стоимость поездки. Твой водитель уже в пути."/>
			   </input>
			  </context>
			 </input>
			</context>
		 </input>
		</context>
	  </input>
	</context>
  </input>
</context>

